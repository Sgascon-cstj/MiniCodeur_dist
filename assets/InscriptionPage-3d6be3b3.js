import{d as re,r as s,A as ne,b as i,c as x,e as ie,g as l,w as u,f as m,t as O,u as t,h as _,l as N,q as B,y as ve,F as de,a as me,i as D}from"./index-0979e10b.js";import{u as ce,a as d}from"./vee-validate.esm-eda5c4dd.js";import{U as fe}from"./UserRepository-f7559e71.js";import{C as pe}from"./ChapterRepository-f357b286.js";const ge=m("h1",{class:"text-h1"},"Inscription",-1),_e={class:"text-h5 mb-6"},be=m("p",{class:"mb-4 text-medium-emphasis text-body-2"},[_(" Tu es officielement membre de la communauté MiniCodeur! > "),m("br"),_(" Connecte toi dès maintenant. ")],-1),we={class:"text-end"},ke=re({__name:"InscriptionPage",setup(ye){const M=s(!1),U=s(!1),r=s(1),J=ne(()=>{switch(r.value){case 1:return"Créer un compte MiniCodeur";case 2:return"Information générales";case 3:return"Mot de passe sécurisé";case 4:return"Compte créé avec succès!"}}),R=new fe,G=new pe,H=s(!1),$=s(!1),P=s(!1),A=s(!1),I=s(!1),L=s(!1),q=s(!1),S=s(!1),F=s(!1),z=s(!1),T=s(!1),{handleSubmit:K}=ce({validationSchema:{firstName(e){return(e==null?void 0:e.length)>=2&&(e==null?void 0:e.length)<=255?(P.value=!0,!0):(P.value=!1,"Le prénom doit contenir entre 2 et 255 caractères.")},lastName(e){return(e==null?void 0:e.length)>=2&&(e==null?void 0:e.length)<=255?(A.value=!0,!0):(A.value=!1,"Le nom doit contenir entre 2 et 255 caractères.")},email(e){return/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(e)?(I.value=!0,!0):(I.value=!1,"Le e-mail doit être valide.")},displayName(e){return(e==null?void 0:e.length)>=2?(L.value=!0,!0):(L.value=!1,"Le nom d'utilisateur doit contenir au moins 2 caractères.")},selectRole(e){return e?(q.value=!0,!0):(q.value=!1,"Choisir une option.")},birthday(e){return e?(S.value=!0,!0):(S.value=!1,"Veuillez choisir votre date de naissance")},password(e){return/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(e)?(F.value=!0,!0):(F.value=!1,"Un mot de passe d'au moins huit caractères, comprenant au moins une lettre majuscule, une lettre minuscule, un chiffre et un caractère spécial.")},passwordConf(e){return e===c.value.value?(z.value=!0,!0):(z.value=!1,"Le mot de passe doit être identique.")},checkbox(e){return e==="1"?(T.value=!0,!0):(T.value=!1,"Accepter les conditions avant de continuer.")}}}),f=d("firstName"),p=d("lastName"),g=d("email"),b=d("displayName"),w=d("selectRole"),c=d("password"),y=d("passwordConf"),V=d("checkbox"),Q=s(["Étudiant(e)","Professeur(e)"]),h=d("birthday"),j=K(e=>{const a=s("");e.selectRole!=="Étudiant(e)"&&(a.value="ROLE_PROF");const n={email:e.email,firstname:e.firstName,lastname:e.lastName,birthday:e.birthday,displayname:e.displayName,password:e.password,roles:[a.value]};X(n)});function W(){switch(r.value){case 1:return P.value===!0&&A.value===!0&&r.value++,P.value===!1&&(f.value.value=f.value.value!==void 0?f.value.value:""),A.value===!1&&(p.value.value=p.value.value!==void 0?p.value.value:""),!0;case 2:return I.value===!0&&L.value===!0&&q.value===!0&&S.value===!0&&r.value++,I.value===!1&&(g.value.value=g.value.value===void 0?"":g.value.value),L.value===!1&&(b.value.value=b.value.value===void 0?"":b.value.value),q.value===!1&&(w.value.value=w.value.value===void 0?"":w.value.value),S.value===!1&&(h.value.value=h.value.value===void 0?"":h.value.value),!0;case 3:return F.value===!0&&z.value===!0&&T.value===!0&&r.value++,F.value===!1&&(c.value.value=c.value.value===void 0?"":c.value.value),z.value===!1&&(y.value.value=y.value.value===void 0?"":y.value.value),T.value===!1&&(V.value.value=V.value.value===void 0?"":V.value.value),!0;case 4:return!0}}async function X(e){try{$.value=!0;const a=await R.register(e);(a==null?void 0:a.status)===201&&($.value=!1,r.value++)}catch{$.value=!1,H.value=!0}}async function Y(){const e=await R.loginCheck(g.value.value,c.value.value);if(e){localStorage.setItem("token",e.token),me.defaults.headers.common={Authorization:`bearer ${e.token}`};const a=await G.retrieveAll();if(a){const n=await R.createProgression(a[0].id_chapter);if((n==null?void 0:n.status)===201){const v=await R.retrieveOne();localStorage.setItem(v.uuid_user,"1"),D.push({name:"home"})}}}}function ee(){D.push({name:"login"})}return(e,a)=>{const n=i("v-text-field"),v=i("v-col"),C=i("v-row"),E=i("v-window-item"),ae=i("v-select"),le=i("v-checkbox"),te=i("v-icon"),Z=i("v-divider"),k=i("v-btn"),oe=i("v-window"),ue=i("v-sheet"),se=i("v-alert");return x(),ie(de,null,[ge,l(ue,{border:"",rounded:"lg",elevation:"10",width:"80vh",class:"mx-auto pa-5 ma-10"},{default:u(()=>[m("form",{onSubmit:a[15]||(a[15]=ve((...o)=>t(j)&&t(j)(...o),["prevent"]))},[m("div",null,[m("span",null,O(J.value),1)]),l(oe,{class:"my-5",modelValue:r.value,"onUpdate:modelValue":a[12]||(a[12]=o=>r.value=o)},{default:u(()=>[l(E,{value:1},{default:u(()=>[l(C,null,{default:u(()=>[l(v,null,{default:u(()=>[l(n,{modelValue:t(f).value.value,"onUpdate:modelValue":a[0]||(a[0]=o=>t(f).value.value=o),counter:255,"error-messages":t(f).errorMessage.value,label:"Prénom"},null,8,["modelValue","error-messages"])]),_:1}),l(v,null,{default:u(()=>[l(n,{modelValue:t(p).value.value,"onUpdate:modelValue":a[1]||(a[1]=o=>t(p).value.value=o),counter:255,"error-messages":t(p).errorMessage.value,label:"Nom"},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(E,{value:2},{default:u(()=>[l(C,null,{default:u(()=>[l(v,null,{default:u(()=>[l(n,{modelValue:t(g).value.value,"onUpdate:modelValue":a[2]||(a[2]=o=>t(g).value.value=o),"error-messages":t(g).errorMessage.value,label:"Courriel"},null,8,["modelValue","error-messages"])]),_:1}),l(v,null,{default:u(()=>[l(n,{modelValue:t(b).value.value,"onUpdate:modelValue":a[3]||(a[3]=o=>t(b).value.value=o),counter:3,"error-messages":t(b).errorMessage.value,label:"Nom d'utilisateur"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),l(C,null,{default:u(()=>[l(v,null,{default:u(()=>[l(ae,{modelValue:t(w).value.value,"onUpdate:modelValue":a[4]||(a[4]=o=>t(w).value.value=o),items:Q.value,transition:"slide-x-transition","error-messages":t(w).errorMessage.value,label:"Je suis ..."},null,8,["modelValue","items","error-messages"])]),_:1}),l(v,null,{default:u(()=>[l(n,{type:"date",modelValue:t(h).value.value,"onUpdate:modelValue":a[5]||(a[5]=o=>t(h).value.value=o),"error-messages":t(h).errorMessage.value,label:"Anniversaire"},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(E,{value:3},{default:u(()=>[l(C,null,{default:u(()=>[l(v,null,{default:u(()=>[l(n,{"append-inner-icon":M.value?"mdi-eye-off":"mdi-eye",type:M.value?"text":"password","onClick:appendInner":a[6]||(a[6]=o=>M.value=!M.value),"prepend-inner-icon":"mdi-lock-outline",modelValue:t(c).value.value,"onUpdate:modelValue":a[7]||(a[7]=o=>t(c).value.value=o),"error-messages":t(c).errorMessage.value,label:"Mot de passe"},null,8,["append-inner-icon","type","modelValue","error-messages"])]),_:1}),l(v,null,{default:u(()=>[l(n,{"append-inner-icon":U.value?"mdi-eye-off":"mdi-eye",type:U.value?"text":"password","onClick:appendInner":a[8]||(a[8]=o=>U.value=!U.value),"prepend-inner-icon":"mdi-lock-plus",modelValue:t(y).value.value,"onUpdate:modelValue":a[9]||(a[9]=o=>t(y).value.value=o),"error-messages":t(y).errorMessage.value,label:"Confirmation"},null,8,["append-inner-icon","type","modelValue","error-messages"])]),_:1})]),_:1}),l(le,{modelValue:t(V).value.value,"onUpdate:modelValue":a[10]||(a[10]=o=>t(V).value.value=o),"error-messages":t(V).errorMessage.value,value:"1",label:"Termes et conditions",type:"checkbox"},null,8,["modelValue","error-messages"])]),_:1}),l(E,{value:4},{default:u(()=>[l(te,{class:"mb-5",color:"success",icon:"mdi-check-circle",size:"112"}),m("h2",_e,"Félicitation, "+O(t(f).value)+" "+O(t(p).value)+"!",1),be,l(Z,{class:"mb-4"}),m("div",we,[l(k,{class:"text-none",color:"success",rounded:"",variant:"flat",width:"13vh",onClick:a[11]||(a[11]=o=>Y())},{default:u(()=>[_(" Connexion ")]),_:1})])]),_:1})]),_:1},8,["modelValue"]),r.value>4?(x(),N(Z,{key:0,class:"mb-4"})):B("",!0),l(C,null,{default:u(()=>[l(v,{class:"d-flex justify-space-between"},{default:u(()=>[r.value>1&&r.value<4?(x(),N(k,{key:0,variant:"text",color:"teal",width:"13vh",onClick:a[13]||(a[13]=o=>r.value--)},{default:u(()=>[_(" Précédent ")]),_:1})):B("",!0),r.value==1?(x(),N(k,{key:1,color:"red",onClick:a[14]||(a[14]=o=>ee()),width:"13vh",class:"mt-4"},{default:u(()=>[_("Annuler")]),_:1})):B("",!0),r.value<3?(x(),N(k,{key:2,color:"teal",variant:"flat",width:"13vh",onClick:W},{default:u(()=>[_(" Suivant ")]),_:1})):B("",!0),r.value==3?(x(),N(k,{key:3,class:"me-4",type:"submit",width:"13vh",color:"teal",loading:$.value},{default:u(()=>[_(" Confirmer ")]),_:1},8,["loading"])):B("",!0)]),_:1})]),_:1})],32)]),_:1}),m("template",null,[l(se,{type:"error",title:"Inscription échoué",text:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Commodi, ratione debitis quis est labore voluptatibus! Eaque cupiditate minima, at placeat totam, magni doloremque veniam neque porro libero rerum unde voluptatem!"})])],64)}}});export{ke as default};
