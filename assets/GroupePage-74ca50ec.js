import{_ as E,D as F}from"./DefaultLayout-9faf5610.js";import{G as T}from"./GroupeRepository-70c3faed.js";import{d as L,r as h,o as I,b as o,c as p,e as R,g as e,w as t,h as y,f as v,t as M,F as S,s as B,l as C,q as $,y as O,p as W,k as H,_ as J}from"./index-0979e10b.js";import{U as K}from"./UserRepository-f7559e71.js";const Q={class:"text-yellow-accent-1"},X=v("hr",null,null,-1),Y={class:""},Z=v("p",null,"Membres",-1),ee=v("hr",null,null,-1),te=v("p",null,"Administrateur",-1),oe=v("p",null,"Membre",-1),le=L({__name:"detailGroup",props:["group"],setup(k){const m=k,c=new T,s=h(),u=h(),_=h(!1),d=h(!1);I(async()=>{var a;await n(),d.value=await c.checkCreator((a=s.value)==null?void 0:a.name)});async function n(){try{if(s.value=await c.retrieveOne(m.group.group_href),s.value){const a=s.value.members;u.value=await c.retrieveMembers(a)}}catch{}}async function i(a){var l;try{const g=await c.deleteMembers((l=s.value)==null?void 0:l.name,a.uuid_user);(g==null?void 0:g.status)==202&&n()}catch{}}async function f(){var a;if(d.value==!1)return!1;try{const l=await c.deleteGroup((a=s.value)==null?void 0:a.name);(l==null?void 0:l.status)==202&&(location.reload(),alert("Le groupe a été supprimé"))}catch{}}return(a,l)=>{const g=o("v-icon"),x=o("v-btn"),b=o("v-col"),G=o("v-row"),U=o("v-card-title"),j=o("v-list-item-title"),q=o("v-list-item"),w=o("v-list"),V=o("v-card-text"),N=o("v-card-actions"),A=o("v-card"),D=o("v-dialog");return p(),R(S,null,[e(x,{color:"white",onClick:l[0]||(l[0]=r=>_.value=!0)},{default:t(()=>[e(g,null,{default:t(()=>[y(" mdi-eye-circle-outline ")]),_:1}),y(" info ")]),_:1}),e(D,{modelValue:_.value,"onUpdate:modelValue":l[3]||(l[3]=r=>_.value=r),width:"50%"},{default:t(()=>[e(A,null,{default:t(()=>[e(U,null,{default:t(()=>{var r;return[e(G,null,{default:t(()=>[e(b,{cols:"6",class:"mb-5"},{default:t(()=>{var P;return[v("h2",Q,M((P=s.value)==null?void 0:P.name),1)]}),_:1}),e(b,{cols:"6"},{default:t(()=>[e(x,{color:"red",onClick:l[1]||(l[1]=P=>f()),"prepend-icon":"mdi-delete"},{default:t(()=>[y("Supprimer le groupe")]),_:1})]),_:1})]),_:1}),X,v("p",Y,M((r=s.value)==null?void 0:r.description),1)]}),_:1}),e(V,{class:"d-block"},{default:t(()=>[Z,ee,e(w,{height:"300px",style:{"overflow-y":"auto"}},{default:t(()=>[(p(!0),R(S,null,B(u.value,(r,P)=>(p(),C(q,{key:P,value:r,color:"primary"},{default:t(()=>[e(G,null,{default:t(()=>[e(b,{cols:"2"},{default:t(()=>[e(E,{user:r.user},null,8,["user"])]),_:2},1024),e(b,{cols:"3"},{default:t(()=>[v("div",null,[e(j,{textContent:M(r.user.displayname)},null,8,["textContent"])])]),_:2},1024),r.isTheCreator?(p(),C(b,{key:0,cols:"4"},{default:t(()=>[te]),_:1})):$("",!0),r.isTheCreator?$("",!0):(p(),C(b,{key:1,cols:"4"},{default:t(()=>[oe]),_:1})),d.value&&!r.isTheCreator?(p(),C(b,{key:2,cols:"2"},{default:t(()=>[e(x,{hint:"Supprimer l'utilisateur",height:"75%",width:"50%",color:"red",onClick:we=>i(r.user),icon:"mdi-delete"},null,8,["onClick"])]),_:2},1024)):$("",!0)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(x,{color:"primary",block:"",onClick:l[2]||(l[2]=r=>_.value=!1)},{default:t(()=>[y("Annuler")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),ne={key:0},ae={key:1},se={width:"100%"},ue=L({__name:"groupeCard",props:["group"],setup(k){const m=k,c=new T;async function s(){try{const u=await c.leftGroup(m.group.name);(u==null?void 0:u.status)==202&&location.reload()}catch(u){console.log(u)}}return(u,_)=>{const d=o("v-icon"),n=o("v-col"),i=o("v-row"),f=o("v-card-title"),a=o("v-card-text"),l=o("v-btn"),g=o("v-card-actions"),x=o("v-card");return p(),C(n,{cols:"2",class:"ma-2"},{default:t(()=>[e(x,{height:"290px"},{default:t(()=>[e(f,null,{default:t(()=>[e(i,{class:"text-center"},{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[m.group.isTheCreator?(p(),R("p",ne,[e(d,null,{default:t(()=>[y("mdi-account-star")]),_:1})])):$("",!0),m.group.isTheCreator?$("",!0):(p(),R("p",ae,[e(d,null,{default:t(()=>[y("mdi-account")]),_:1})])),e(i,null,{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[v("p",se,M(m.group.name),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(a,null,{default:t(()=>[e(i,null,{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[e(d,null,{default:t(()=>[y("mdi-account-group")]),_:1})]),_:1}),e(n,{cols:"12"},{default:t(()=>[v("p",null,M(m.group.description),1)]),_:1}),e(n,{cols:"12"},{default:t(()=>[v("p",null,"Participants: "+M(m.group.nbUser),1)]),_:1})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[e(le,{group:m.group},null,8,["group"]),m.group.isTheCreator?$("",!0):(p(),C(l,{key:0,onClick:_[0]||(_[0]=b=>s()),color:"red",class:"ml-1",icon:"mdi-delete"}))]),_:1})]),_:1})]),_:1})]),_:1})}}}),re=v("h1",{class:"mb-4 text-cyan-accent-2"},"Création d'un groupe",-1),ce=L({__name:"newGroup",setup(k){const m=new T,c=h(!1),s=h(),u=h(),_=h(),d={required:a=>!!a||"Champs requis",length:a=>a&&a.length<=15||"Le nom du groupe ne doit pas dépasser 15 caractères"},n=new K,i=h();I(async()=>{i.value=await n.retrieveOne()});async function f(){if(s.value&&u.value&&_.value)try{const a={name:s.value,description:u.value,groupPassword:_.value};if(s.value.length>15){alert("Le nom du groupe ne doit pas dépasser 15 caractères");return}const l=await m.create(a);l=="Le groupe a bien été créé"?(alert(l),c.value=!1,location.reload()):alert(l)}catch{}else alert("Veuillez remplir tous les champs")}return(a,l)=>{var A,D;const g=o("v-text-field"),x=o("v-btn"),b=o("v-form"),G=o("v-sheet"),U=o("v-card-text"),j=o("v-col"),q=o("v-row"),w=o("v-card-actions"),V=o("v-card"),N=o("v-dialog");return((A=i.value)==null?void 0:A.roles.at(0))=="ROLE_PROF"||((D=i.value)==null?void 0:D.roles.at(0))=="ROLE_ADMIN"?(p(),C(x,{key:0,color:"primary",class:"ml-2"},{default:t(()=>[y(" Créer un groupe "),e(N,{modelValue:c.value,"onUpdate:modelValue":l[6]||(l[6]=r=>c.value=r),activator:"parent",width:"auto"},{default:t(()=>[e(V,null,{default:t(()=>[e(U,null,{default:t(()=>[re,e(G,{width:"300",class:"mx-auto"},{default:t(()=>[e(b,{onSubmit:l[4]||(l[4]=O(()=>{},["prevent"]))},{default:t(()=>[e(g,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=r=>s.value=r),rules:[d.required,d.length],label:"Nom du groupe"},null,8,["modelValue","rules"]),e(g,{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=r=>u.value=r),rules:[d.required],label:"Description"},null,8,["modelValue","rules"]),e(g,{modelValue:_.value,"onUpdate:modelValue":l[2]||(l[2]=r=>_.value=r),rules:[d.required],label:"Mot de passe"},null,8,["modelValue","rules"]),e(x,{type:"submit",onClick:l[3]||(l[3]=r=>f()),block:"",class:"mt-2"},{default:t(()=>[y("Créer")]),_:1})]),_:1})]),_:1})]),_:1}),e(w,null,{default:t(()=>[e(q,null,{default:t(()=>[e(j,{cols:"12"},{default:t(()=>[e(x,{color:"primary",block:"",onClick:l[5]||(l[5]=r=>c.value=!1)},{default:t(()=>[y("Annuler")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})):$("",!0)}}}),_e={key:0,class:"text-red-accent-1"},de=L({__name:"groupPassword",props:["group"],setup(k){const m=k,c=new T,s=h(null),u=h(!1),_=h(!1),d={required:i=>!!i||"Champs requis"};async function n(){if(s.value)try{await c.joinGroup(m.group.name,s.value),u.value=!1,location.reload(),_.value=!1}catch{_.value=!0}}return(i,f)=>{const a=o("v-text-field"),l=o("v-btn"),g=o("v-form"),x=o("v-sheet"),b=o("v-card-text"),G=o("v-col"),U=o("v-row"),j=o("v-card-actions"),q=o("v-card"),w=o("v-dialog");return p(),C(l,{color:"primary",class:"ml-2"},{default:t(()=>[y(" Rejoindre "),e(w,{modelValue:u.value,"onUpdate:modelValue":f[4]||(f[4]=V=>u.value=V),activator:"parent",width:"auto"},{default:t(()=>[e(q,null,{default:t(()=>[e(b,null,{default:t(()=>[e(x,{width:"300",class:"mx-auto"},{default:t(()=>[e(g,{onSubmit:f[2]||(f[2]=O(()=>{},["prevent"]))},{default:t(()=>[_.value?(p(),R("p",_e,"Mauvais mot de passe")):$("",!0),e(a,{modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=V=>s.value=V),type:"password",rules:[d.required],label:"Mot de passe"},null,8,["modelValue","rules"]),e(l,{onClick:f[1]||(f[1]=V=>n()),type:"submit",block:"",class:"mt-2"},{default:t(()=>[y("Rejoindre")]),_:1})]),_:1})]),_:1})]),_:1}),e(j,null,{default:t(()=>[e(U,null,{default:t(()=>[e(G,{cols:"12"},{default:t(()=>[e(l,{color:"primary",block:"",onClick:f[3]||(f[3]=V=>u.value=!1)},{default:t(()=>[y("Annuler")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),ie=v("h1",{class:"mb-2 text-primary"},"Rejoindre un groupe",-1),pe=v("hr",null,null,-1),ve=L({__name:"joinGroupe",setup(k){const m=new T,c=h();I(async()=>{await s()});async function s(){c.value=await m.retrieveAll()}const u=h(!1);async function _(d){var n;await s(),c.value=(n=c.value)==null?void 0:n.filter(i=>i.name.includes(d))}return(d,n)=>{const i=o("v-btn"),f=o("v-combobox"),a=o("v-icon"),l=o("v-col"),g=o("v-row"),x=o("v-list-item"),b=o("v-list"),G=o("v-card-text"),U=o("v-card-actions"),j=o("v-card"),q=o("v-dialog");return p(),R(S,null,[e(i,{color:"primary",onClick:n[0]||(n[0]=w=>u.value=!0)},{default:t(()=>[y(" Rejoindre un groupe ")]),_:1}),e(q,{modelValue:u.value,"onUpdate:modelValue":n[3]||(n[3]=w=>u.value=w),width:"50%"},{default:t(()=>[e(j,null,{default:t(()=>[e(G,{class:"text-center"},{default:t(()=>[ie,pe,e(f,{ref:"searchBar",class:"ma-5 mb-1",outlined:"",dense:"","hide-no-data":"",placeholder:"Rechecher un groupe",rounded:"","onUpdate:search":n[1]||(n[1]=w=>_(w)),variant:"solo","prepend-icon":"mdi-magnify"},null,512),e(b,{height:"300px",style:{"overflow-y":"auto"}},{default:t(()=>[(p(!0),R(S,null,B(c.value,w=>(p(),C(x,null,{default:t(()=>[e(g,null,{default:t(()=>[e(l,{cols:"2"},{default:t(()=>[e(a,null,{default:t(()=>[y("mdi-account-group")]),_:1})]),_:1}),e(l,{cols:"3 "},{default:t(()=>[v("p",null,M(w.name),1)]),_:2},1024),e(l,{cols:"4"},{default:t(()=>[v("p",null,M(w.description),1)]),_:2},1024),e(l,{cols:"3 text-center"},{default:t(()=>[e(de,{group:w},null,8,["group"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1}),e(U,null,{default:t(()=>[e(i,{color:"primary",block:"",onClick:n[2]||(n[2]=w=>u.value=!1)},{default:t(()=>[y("Annuler")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),z=k=>(W("data-v-3d9557b0"),k=k(),H(),k),me=z(()=>v("div",{class:"row"},[v("h1",null,"Groupes")],-1)),fe=z(()=>v("hr",{class:"my-4 centered"},null,-1)),ge={key:0,class:"centered-text"},ye=L({__name:"GroupePage",setup(k){const m=new T,c=h();return I(async()=>{c.value=await m.retrieveMyGroup()}),(s,u)=>{const _=o("v-col"),d=o("v-row");return p(),C(F,null,{default:t(()=>[me,fe,e(d,{class:"ma-5"},{default:t(()=>[e(_,{cols:"4",offset:"8"},{default:t(()=>[e(d,null,{default:t(()=>[e(_,{cols:"12"},{default:t(()=>[e(ve),e(ce)]),_:1})]),_:1})]),_:1}),e(_,{cols:"12"},{default:t(()=>[e(d,{class:"ma-3"},{default:t(()=>{var n;return[(p(!0),R(S,null,B(c.value,i=>(p(),C(ue,{group:i},null,8,["group"]))),256)),((n=c.value)==null?void 0:n.length)===0?(p(),R("h3",ge,"Vous n'avez pas encore rejoint de groupe. Rejoignez-en un maintenant.")):$("",!0)]}),_:1})]),_:1})]),_:1})]),_:1})}}});const Ce=J(ye,[["__scopeId","data-v-3d9557b0"]]);export{Ce as default};
