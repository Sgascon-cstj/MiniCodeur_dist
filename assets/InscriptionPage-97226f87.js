import{d as se,r as s,A as re,b as n,c as k,e as ne,g as l,w as o,f as m,t as O,u as t,h as _,l as N,q as B,y as ie,F as ve,a as de,i as D}from"./index-53daf855.js";import{u as me,a as d}from"./vee-validate.esm-03b00b38.js";import{U as ce}from"./UserRepository-b877087a.js";const fe=m("h1",{class:"text-h1"},"Inscription",-1),pe={class:"text-h5 mb-6"},ge=m("p",{class:"mb-4 text-medium-emphasis text-body-2"},[_(" Tu es officielement membre de la communauté MiniCodeur! > "),m("br"),_(" Connecte toi dès maintenant. ")],-1),_e={class:"text-end"},xe=se({__name:"InscriptionPage",setup(be){const M=s(!1),U=s(!1),r=s(1),J=re(()=>{switch(r.value){case 1:return"Créer un compte MiniCodeur";case 2:return"Information générales";case 3:return"Mot de passe sécurisé";case 4:return"Compte créé avec succès!"}}),R=new ce,G=s(!1),$=s(!1),I=s(!1),L=s(!1),P=s(!1),q=s(!1),A=s(!1),F=s(!1),S=s(!1),z=s(!1),T=s(!1),{handleSubmit:H}=me({validationSchema:{firstName(a){return(a==null?void 0:a.length)>=2?(I.value=!0,!0):(I.value=!1,"Le prénom doit contenir au moins 2 caractères.")},lastName(a){return(a==null?void 0:a.length)>=2?(L.value=!0,!0):(L.value=!1,"Le nom doit contenir au moins 2 caractères.")},email(a){return/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(a)?(P.value=!0,!0):(P.value=!1,"Le e-mail doit être valide.")},displayName(a){return(a==null?void 0:a.length)>=2?(q.value=!0,!0):(q.value=!1,"Le nom d'utilisateur doit contenir au moins 2 caractères.")},selectRole(a){return a?(A.value=!0,!0):(A.value=!1,"Choisir une option.")},birthday(a){return a?(F.value=!0,!0):(F.value=!1,"Veuillez choisir votre date de naissance")},password(a){return/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(a)?(S.value=!0,!0):(S.value=!1,"Un mot de passe d'au moins huit caractères, comprenant au moins une lettre majuscule, une lettre minuscule, un chiffre et un caractère spécial.")},passwordConf(a){return a===c.value.value?(z.value=!0,!0):(z.value=!1,"Le mot de passe doit être identique.")},checkbox(a){return a==="1"?(T.value=!0,!0):(T.value=!1,"Accepter les conditions avant de continuer.")}}}),f=d("firstName"),p=d("lastName"),g=d("email"),b=d("displayName"),w=d("selectRole"),c=d("password"),y=d("passwordConf"),V=d("checkbox"),K=s(["Étudiant(e)","Professeur(e)"]),x=d("birthday"),j=H(a=>{const e=s("");a.selectRole!=="Étudiant(e)"&&(e.value="ROLE_PROF");const i={email:a.email,firstname:a.firstName,lastname:a.lastName,birthday:a.birthday,displayname:a.displayName,password:a.password,roles:[e.value]};W(i)});function Q(){switch(r.value){case 1:return I.value===!0&&L.value===!0&&r.value++,I.value===!1&&(f.value.value=f.value.value!==void 0?f.value.value:""),L.value===!1&&(p.value.value=p.value.value!==void 0?p.value.value:""),!0;case 2:return P.value===!0&&q.value===!0&&A.value===!0&&F.value===!0&&r.value++,P.value===!1&&(g.value.value=g.value.value===void 0?"":g.value.value),q.value===!1&&(b.value.value=b.value.value===void 0?"":b.value.value),A.value===!1&&(w.value.value=w.value.value===void 0?"":w.value.value),F.value===!1&&(x.value.value=x.value.value===void 0?"":x.value.value),!0;case 3:return S.value===!0&&z.value===!0&&T.value===!0&&r.value++,S.value===!1&&(c.value.value=c.value.value===void 0?"":c.value.value),z.value===!1&&(y.value.value=y.value.value===void 0?"":y.value.value),T.value===!1&&(V.value.value=V.value.value===void 0?"":V.value.value),!0;case 4:return!0}}async function W(a){try{$.value=!0;const e=await R.register(a);(e==null?void 0:e.status)===201&&($.value=!1,r.value++)}catch{$.value=!1,G.value=!0}}async function X(){const a=await R.loginCheck(g.value.value,c.value.value);if(a){localStorage.setItem("token",a.token),de.defaults.headers.common={Authorization:`bearer ${a.token}`};const e=await R.createProgression(1);if((e==null?void 0:e.status)===201){const i=await R.retrieveOne();localStorage.setItem(i.uuid_user,"1"),D.push({name:"home"})}}}function Y(){D.push({name:"login"})}return(a,e)=>{const i=n("v-text-field"),v=n("v-col"),h=n("v-row"),E=n("v-window-item"),ee=n("v-select"),ae=n("v-checkbox"),le=n("v-icon"),Z=n("v-divider"),C=n("v-btn"),te=n("v-window"),ue=n("v-sheet"),oe=n("v-alert");return k(),ne(ve,null,[fe,l(ue,{border:"",rounded:"lg",elevation:"10",width:"80vh",class:"mx-auto pa-5 ma-10"},{default:o(()=>[m("form",{onSubmit:e[15]||(e[15]=ie((...u)=>t(j)&&t(j)(...u),["prevent"]))},[m("div",null,[m("span",null,O(J.value),1)]),l(te,{class:"my-5",modelValue:r.value,"onUpdate:modelValue":e[12]||(e[12]=u=>r.value=u)},{default:o(()=>[l(E,{value:1},{default:o(()=>[l(h,null,{default:o(()=>[l(v,null,{default:o(()=>[l(i,{modelValue:t(f).value.value,"onUpdate:modelValue":e[0]||(e[0]=u=>t(f).value.value=u),counter:2,"error-messages":t(f).errorMessage.value,label:"Prénom"},null,8,["modelValue","error-messages"])]),_:1}),l(v,null,{default:o(()=>[l(i,{modelValue:t(p).value.value,"onUpdate:modelValue":e[1]||(e[1]=u=>t(p).value.value=u),counter:2,"error-messages":t(p).errorMessage.value,label:"Nom"},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(E,{value:2},{default:o(()=>[l(h,null,{default:o(()=>[l(v,null,{default:o(()=>[l(i,{modelValue:t(g).value.value,"onUpdate:modelValue":e[2]||(e[2]=u=>t(g).value.value=u),"error-messages":t(g).errorMessage.value,label:"Courriel"},null,8,["modelValue","error-messages"])]),_:1}),l(v,null,{default:o(()=>[l(i,{modelValue:t(b).value.value,"onUpdate:modelValue":e[3]||(e[3]=u=>t(b).value.value=u),counter:3,"error-messages":t(b).errorMessage.value,label:"Nom d'utilisateur"},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),l(h,null,{default:o(()=>[l(v,null,{default:o(()=>[l(ee,{modelValue:t(w).value.value,"onUpdate:modelValue":e[4]||(e[4]=u=>t(w).value.value=u),items:K.value,transition:"slide-x-transition","error-messages":t(w).errorMessage.value,label:"Je suis ..."},null,8,["modelValue","items","error-messages"])]),_:1}),l(v,null,{default:o(()=>[l(i,{type:"date",modelValue:t(x).value.value,"onUpdate:modelValue":e[5]||(e[5]=u=>t(x).value.value=u),"error-messages":t(x).errorMessage.value,label:"Anniversaire"},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(E,{value:3},{default:o(()=>[l(h,null,{default:o(()=>[l(v,null,{default:o(()=>[l(i,{"append-inner-icon":M.value?"mdi-eye-off":"mdi-eye",type:M.value?"text":"password","onClick:appendInner":e[6]||(e[6]=u=>M.value=!M.value),"prepend-inner-icon":"mdi-lock-outline",modelValue:t(c).value.value,"onUpdate:modelValue":e[7]||(e[7]=u=>t(c).value.value=u),"error-messages":t(c).errorMessage.value,label:"Mot de passe"},null,8,["append-inner-icon","type","modelValue","error-messages"])]),_:1}),l(v,null,{default:o(()=>[l(i,{"append-inner-icon":U.value?"mdi-eye-off":"mdi-eye",type:U.value?"text":"password","onClick:appendInner":e[8]||(e[8]=u=>U.value=!U.value),"prepend-inner-icon":"mdi-lock-plus",modelValue:t(y).value.value,"onUpdate:modelValue":e[9]||(e[9]=u=>t(y).value.value=u),"error-messages":t(y).errorMessage.value,label:"Confirmation"},null,8,["append-inner-icon","type","modelValue","error-messages"])]),_:1})]),_:1}),l(ae,{modelValue:t(V).value.value,"onUpdate:modelValue":e[10]||(e[10]=u=>t(V).value.value=u),"error-messages":t(V).errorMessage.value,value:"1",label:"Termes et conditions",type:"checkbox"},null,8,["modelValue","error-messages"])]),_:1}),l(E,{value:4},{default:o(()=>[l(le,{class:"mb-5",color:"success",icon:"mdi-check-circle",size:"112"}),m("h2",pe,"Félicitations, "+O(t(f).value)+" "+O(t(p).value)+"!",1),ge,l(Z,{class:"mb-4"}),m("div",_e,[l(C,{class:"text-none",color:"success",rounded:"",variant:"flat",width:"13vh",onClick:e[11]||(e[11]=u=>X())},{default:o(()=>[_(" Connexion ")]),_:1})])]),_:1})]),_:1},8,["modelValue"]),r.value>4?(k(),N(Z,{key:0,class:"mb-4"})):B("",!0),l(h,null,{default:o(()=>[l(v,{class:"d-flex justify-space-between"},{default:o(()=>[r.value>1&&r.value<4?(k(),N(C,{key:0,variant:"text",color:"teal",width:"13vh",onClick:e[13]||(e[13]=u=>r.value--)},{default:o(()=>[_(" Back ")]),_:1})):B("",!0),r.value==1?(k(),N(C,{key:1,color:"red",onClick:e[14]||(e[14]=u=>Y()),width:"13vh",class:"mt-4"},{default:o(()=>[_("Annuler")]),_:1})):B("",!0),r.value<3?(k(),N(C,{key:2,color:"teal",variant:"flat",width:"13vh",onClick:Q},{default:o(()=>[_(" Next ")]),_:1})):B("",!0),r.value==3?(k(),N(C,{key:3,class:"me-4",type:"submit",width:"13vh",color:"teal",loading:$.value},{default:o(()=>[_(" Confirmer ")]),_:1},8,["loading"])):B("",!0)]),_:1})]),_:1})],32)]),_:1}),m("template",null,[l(oe,{type:"error",title:"Inscription échoué",text:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Commodi, ratione debitis quis est labore voluptatibus! Eaque cupiditate minima, at placeat totam, magni doloremque veniam neque porro libero rerum unde voluptatem!"})])],64)}}});export{xe as default};
